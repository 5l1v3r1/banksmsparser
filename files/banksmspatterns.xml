<?xml version="1.0" encoding="UTF-8" ?>
<!--
    match - шаблон соответствия шаблона
    cardId - шаблон определения карты или счета
    amount - шаблон определения суммы
    detail - шаблон определения дополнительной информации из смс
    decimal_char - символ разделителя дробной части (по-умолчанию ".")
    decimal_group_char - символ разделителя разрядов (по-умолчанию "")
-->
<content>
    <version>1</version>
    <updated>2017.12.15</updated>
    <operations>
        <operation name="expense">expense</operation>
    </operations>
    <banks>
        <bank id="tinkoff">Tinkoff</bank>
        <bank id="alfabank">Альфа-Банк</bank>
        <bank id="sberbank">Сбербанк России</bank>
        <bank id="vtb24">ВТБ-24</bank>
    </banks>
    <bank_phones>
        <phone bankId="tinkoff">Tinkoff</phone>
        <phone bankId="tinkoff">tinkoff</phone>
        <phone bankId="sberbank">900</phone>
        <phone bankId="alfabank">Alfa-Bank</phone>
        <phone bankId="alfabank">2265</phone>
        <phone bankId="alfabank">+79037672265</phone>
        <phone bankId="vtb24">VTB24</phone>
    </bank_phones>
    <system>
        <system_sms bankId="tinkoff"><![CDATA[Задолженность по налогу.*]]></system_sms>
        <system_sms bankId="tinkoff"><![CDATA[Vhod v Tinkoff.ru.*]]></system_sms>
        <system_sms bankId="sberbank"><![CDATA[Вход в Сбербанк Онлайн для Android.*]]></system_sms>
        <system_sms bankId="sberbank"><![CDATA[.*пароль:\s\d+.*]]></system_sms>
        <system_sms bankId="sberbank"><![CDATA[(Сбербанк Онлайн).*(перевел).*]]></system_sms>
    </system>
    <patterns bankId="tinkoff">
        <!-- Pokupka. Karta *9930. Summa 167.90 RUB. PYATEROCHKA, CHELYABINSK. 05.12.2017 16:20. Dostupno 41711.07 RUB. Tinkoff.ru-->
        <pattern category="expense">
            <match><![CDATA[Pokupka.*]]></match>
            <cardId group="0"><![CDATA[(?<=(Karta\s\*))\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=Summa\s)(\d+\.\d{2})]]></amount>
            <detail group="2"><![CDATA[(RUB|USD|EUR).\s(.*)\.\s\d{2}\.\d{2}]]></detail>
        </pattern>
        <!-- Покупка. Карта *0380. 126 RUB. YANDEX.GOODS. Баланс 22601 RUB-->
        <!-- Покупка. Карта *9930. 175 RUB. GRANDVERA. Доступно 54093 RUB-->
        <pattern category="expense">
            <match><![CDATA[Покупка.*]]></match>
            <cardId group="0"><![CDATA[(?<=(Карта\s\*))\d{4}]]></cardId>
            <amount group="1"><![CDATA[\d{4}.\s(\d*.?\d{1,2})\s]]></amount>
            <detail group="0"><![CDATA[(?<=(RUB|USD|EUR)\.\s).*(?=\.\s(Баланс|Доступно))]]></detail>
        </pattern>
        <!-- Jur. perevod. Karta *9930. Summa 3270.63 RUB. iBank. 07.12.2017 10:11. Dostupno 56644.39 RUB. Tinkoff.ru-->
        <pattern category="jur.perevod">
            <match><![CDATA[Jur. perevod.*]]></match>
            <cardId group="0"><![CDATA[(?<=(Karta\s\*))\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=Summa\s)(\d+\.\d{2})]]></amount>
            <detail group="2"><![CDATA[(RUB|USD|EUR).\s(.*)\.\s\d{2}\.\d{2}]]></detail>
        </pattern>
        <!-- Popolnenie. Karta *9930. Summa 8000 RUB. Card2Card. 07.12.2017 15:31. Dostupno 61967.41 RUB. Tinkoff.ru-->
        <pattern category="popolnenie">
            <match><![CDATA[Popolnenie.*]]></match>
            <cardId group="0"><![CDATA[(?<=(Karta\s\*))\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=Summa\s)\d+\.?\d{1,2}]]></amount>
            <detail group="2"><![CDATA[(RUB|USD|EUR).\s(.*)\.\s\d{2}\.\d{2}]]></detail>
        </pattern>
        <!-- Vnutrenniy perevod sebe. Karta *9930. Summa 25000 RUB. mBank. 09.12.2017 05:20. Dostupno 61972.03 RUB. Tinkoff.ru-->
        <pattern category="perevod">
            <match><![CDATA[Vnutrenniy perevod sebe.*]]></match>
            <cardId group="0"><![CDATA[(?<=(Karta\s\*))\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=Summa\s)\d+\.?\d{1,2}]]></amount>
        </pattern>
        <!-- Perevod na kartu. Karta *9930. Summa 1000 RUB. TINKOFF BANK CARD2CARD. 12.12.2017 18:06. Dostupno 56706 RUB. Tinkoff.ru-->
        <pattern category="perevod_card">
            <match><![CDATA[Perevod na kartu.*]]></match>
            <cardId group="0"><![CDATA[(?<=(Karta\s\*))\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=Summa\s)\d+\.?\d{1,2}]]></amount>
        </pattern>
    </patterns>
    <patterns bankId="alfabank">
        <!-- 5*9857; Pokupka; Uspeshno; Summa: 110,00 RUR; Ostatok: 137372,27 RUR; RU/CHELYABINSK/SOKOL FIT DER NOVOE PO; 04.12.2017 13:33:17-->
        <pattern category="expense">
            <match><![CDATA[.*\sPokupka\;.*]]></match>
            <cardId group="0"><![CDATA[(?<=(4|5)\*)\d{4}]]></cardId>
            <amount group="1"><![CDATA[Summa:\s(\d+\,\d{2})]]></amount>
            <detail group="1"><![CDATA[\sOstatok:\s[0-9,]*\sRUR;\s([^;]*);]]></detail>
            <decimal_char optional="true">,</decimal_char>
        </pattern>
        <!-- 5*9857; Postupleniye; Summa: 1300,00 RUR; Ostatok: 137482,27 RUR; 03.12.2017; Otkrojte schet 'Semejnyj' v mobil'nom banke https://alfabank.ru/app-->
        <pattern category="popolnenie">
            <match><![CDATA[.*Postupleniye\;.*]]></match>
            <cardId group="0"><![CDATA[(?<=(4|5)\*)\d{4}]]></cardId>
            <amount group="1"><![CDATA[Summa:\s(\d+\,\d{2})]]></amount>
            <decimal_char optional="true">,</decimal_char>
        </pattern>
        <!-- Spisanie so scheta 408*32167 na summu 1,500.00 RUR, poluchatel platezha 408*32255; 04.12.2017 21:28:02-->
        <pattern category="perevod">
            <match><![CDATA[Spisanie so scheta.*]]></match>
            <cardId group="1"><![CDATA[Spisanie\sso\sscheta\s(.*)\sna]]></cardId>
            <amount group="1"><![CDATA[na summu\s(.*)\sRUR]]></amount>
            <decimal_group_char optional="true">,</decimal_group_char>
        </pattern>
    </patterns>
    <patterns bankId="sberbank">
        <!--VISA6168 06.12.17 11:30 списание 700р Баланс: 2682.45р-->
        <pattern category="spisanie">
            <match><![CDATA[.*списание\s\d.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=списание\s)\d*\.?\d{1,2}]]></amount>
        </pattern>
        <!--VISA6470 04.12.17 08:18 оплата 200р MTS OAO Баланс: 4278.81р-->
        <pattern category="expense">
            <match><![CDATA[.*оплата\s\d.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=оплата\s)\d*\.?\d{1,2}]]></amount>
            <detail group="1"><![CDATA[р\s(.*)(?=\s(Б|б)аланс)]]></detail>
        </pattern>
        <!--MIR-3075 13.12.17 17:39 покупка 1200р VNUKOVO.AIRLINES AEROP Баланс: 1276.46р-->
        <pattern category="expense">
            <match><![CDATA[.*покупка\s\d.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=покупка\s)\d*\.?\d{1,2}]]></amount>
            <detail group="1"><![CDATA[р\s(.*)(?=\s(Б|б)аланс)]]></detail>
        </pattern>
        <!--VISA6168 02.12.17 08:45 зачисление 30000р ATM 335417 Баланс: 33382.45р-->
        <pattern category="zachislenie_ATM">
            <match><![CDATA[.*зачисление\s\d.*ATM.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=зачисление\s)\d*\.?\d{1,2}]]></amount>
            <detail group="1"><![CDATA[р\s(.*)(?=\s(Б|б)аланс)]]></detail>
        </pattern>
        <!--VISA6168 09.12.17 19:07 зачисление 10000р с Вашего вклада. Баланс: 12682.45р-->
        <!--MAES0515 11.12.17 12:24 зачисление пенсии 10471.91р Баланс: 12934.80р-->
        <pattern category="zachislenie">
            <match><![CDATA[.*зачисление\s\d*[^\s]*\s(?!ATM).*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="2"><![CDATA[зачисление\s(пенсии\s)?(\d*\.?\d{1,2})]]></amount>
        </pattern>
        <!--VISA6168 13.12.17 14:18 выдача 5000р ATM 861320 Баланс: 97.45р-->
        <pattern category="vida4a_ATM">
            <match><![CDATA[.*выдача\s\d.*ATM.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=выдача\s)\d*\.?\d{1,2}]]></amount>
            <detail group="1"><![CDATA[р\s(.*)(?=\s(Б|б)аланс)]]></detail>
        </pattern>
        <!--VISA0000 10.12.17 оплата Мобильного банка за 10/12/2017-09/01/2018 60р Баланс: 00000.00р-->
        <pattern category="pay_iBank">
            <match><![CDATA[.*оплата\sМобильного\sбанка.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="2"><![CDATA[(\/\d{4}\s)(\d*\.?\d{1,2})]]></amount>
        </pattern>
        <!--VISA0000: перевод 400р. на карту получателя ВЕРОНИКА АЛЕКСАНДРОВНА П. выполнен. Подробнее в выписке по карте http://sberbank.ru/sms/h2/-->
        <pattern category="perevod">
            <match><![CDATA[..*перевод.*]]></match>
            <cardId group="0"><![CDATA[(MIR-|VISA|MAES|ORPS|ECMC)\d{4}]]></cardId>
            <amount group="0"><![CDATA[(?<=перевод\s)\d*\.?\d{1,2}]]></amount>
        </pattern>
    </patterns>
    <patterns bankId="vtb24">
        <!--Karta *0000: Oplata 303.50 RUR; VREMYA ZDOROVYA; 14.11.2017 19:41, dostupno сумма RUR. VTB24-->
        <pattern category="expense">
            <match><![CDATA[.*Oplata.*]]></match>
            <cardId group="1"><![CDATA[Karta\s\*(\d{4})]]></cardId>
            <amount group="1"><![CDATA[Oplata\s(\d+\.\d{2})]]></amount>
            <detail group="1"><![CDATA[.*;\s(.*);\s\d]]></detail>
        </pattern>
    </patterns>
</content>